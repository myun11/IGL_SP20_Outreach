Q_raw = matrix(c(
  0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,1,2,3,4,5,6,5, 4,3,2,1,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,1,2,3,4,5,6, 5,4,3,2,1,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,1,2,3,4,5, 6,5,4,3,2,1,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,1,2,3,4, 5,6,5,4,3,2,1,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,1,2,3, 4,5,6,5,4,3,2,1,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,1,2, 3,4,5,6,5,4,3,2,1,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,1, 2,3,4,5,6,5,4,3,2,1, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 1,2,3,4,5,6,5,4,3,2, 1,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,5,4,3, 2,1,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
               
  0,0,0,0,0,0,0,0,0,0, 0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,1,2,3,4,5,6,5, 4,3,2,1,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,1,2,3,4,5,6, 5,4,3,2,1,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,1,2,3,4,5, 6,5,4,3,2,1,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,1,2,3,4, 5,6,5,4,3,2,1,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,1,2,3, 4,5,6,5,4,3,2,1,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,1,2, 3,4,5,6,5,4,3,2,1,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1, 2,3,4,5,6,5,4,3,2,1, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1,2,3,4,5,6,5,4,3,2, 1,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,5,4,3, 2,1,0,0,0,0,0,0,0,0, 0,0,0,0,
                 
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,1,2,3,4,5,6,5, 4,3,2,1,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,1,2,3,4,5,6, 5,4,3,2,1,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,1,2,3,4,5, 6,5,4,3,2,1,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,1,2,3,4, 5,6,5,4,3,2,1,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,1,2,3, 4,5,6,5,4,3,2,1,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,1,2, 3,4,5,6,5,4,3,2,1,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1, 2,3,4,5,6,5,4,3,2,1, 0,0,0,0,
  1,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1,2,3,4,5,6,5,4,3,2, 0,0,0,0,
  2,1,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,5,4,3, 0,0,0,0,
          
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 36,0,0,0,
  4,3,2,1,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,1,2,3,4,5,6,5, 0,0,0,0,
  5,4,3,2,1,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,1,2,3,4,5,6, 0,0,0,0,
  6,5,4,3,2,1,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,1,2,3,4,5, 0,0,0,0,
  5,6,5,4,3,2,1,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,1,2,3,4, 0,0,0,0,
  4,5,6,5,4,3,2,1,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,1,2,3, 0,0,0,0,
  3,4,5,6,5,4,3,2,1,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,1,2, 0,0,0,0,
  2,3,4,5,6,5,4,3,2,1, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1, 0,0,0,0,
  1,2,3,4,5,6,5,4,3,2, 1,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,1,2,3,4,5,6,5,4,3, 2,1,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,

  0,0,0,0,0,0,0,0,0,0, 0,0,1,0,1,0,1,0,1,0, 1,0,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,30,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,1,0,1,0,1,0,1,0, 1,0,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,30,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,1,0,1,0,1,0,1,0, 1,0,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,30,
  0,0,0,0,0,0,0,0,0,0, 0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0
  
), nrow = 44, byrow = TRUE)
Q = Q_raw/36

Q_raw_kparam1 = matrix(c(
  0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,1,2,3,4,5,6,5, 4,3,2,1,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,1,2,3,4,5,6, 5,4,3,2,1,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,1,2,3,4,5, 6,5,4,3,2,1,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,1,2,3,4, 5,6,5,4,3,2,1,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,1,2,3, 4,5,6,5,4,3,2,1,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,1,2, 3,4,5,6,5,4,3,2,1,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,1, 2,3,4,5,6,5,4,3,2,1, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 1,2,3,4,5,6,5,4,3,2, 1,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,5,4,3, 2,1,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  
  0,0,0,0,0,0,0,0,0,0, 0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,1,2,3,4,5,6,5, 4,3,2,1,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,1,2,3,4,5,6, 5,4,3,2,1,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,1,2,3,4,5, 6,5,4,3,2,1,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,1,2,3,4, 5,6,5,4,3,2,1,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,1,2,3, 4,5,6,5,4,3,2,1,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,1,2, 3,4,5,6,5,4,3,2,1,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1, 2,3,4,5,6,5,4,3,2,1, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1,2,3,4,5,6,5,4,3,2, 1,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,5,4,3, 2,1,0,0,0,0,0,0,0,0, 0,0,0,0,
  
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,1,2,3,4,5,6,5, 4,3,2,1,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,1,2,3,4,5,6, 5,4,3,2,1,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,1,2,3,4,5, 6,5,4,3,2,1,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,1,2,3,4, 5,6,5,4,3,2,1,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,1,2,3, 4,5,6,5,4,3,2,1,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,1,2, 3,4,5,6,5,4,3,2,1,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1, 2,3,4,5,6,5,4,3,2,1, 0,0,0,0,
  1,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1,2,3,4,5,6,5,4,3,2, 0,0,0,0,
  2,1,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,1,2,3,4,5,6,5,4,3, 0,0,0,0,
  
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 36,0,0,0,
  4,3,2,1,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,1,2,3,4,5,6,5, 0,0,0,0,
  5,4,3,2,1,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,1,2,3,4,5,6, 0,0,0,0,
  6,5,4,3,2,1,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,1,2,3,4,5, 0,0,0,0,
  5,6,5,4,3,2,1,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,1,2,3,4, 0,0,0,0,
  4,5,6,5,4,3,2,1,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,1,2,3, 0,0,0,0,
  3,4,5,6,5,4,3,2,1,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,1,2, 0,0,0,0,
  2,3,4,5,6,5,4,3,2,1, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1, 0,0,0,0,
  1,2,3,4,5,6,5,4,3,2, 1,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,1,2,3,4,5,6,5,4,3, 2,1,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  
  0,0,0,0,0,0,0,0,0,0, 0,0,1,2,3,4,5,6,5,4, 3,2,1,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0
  
), nrow = 44, byrow = TRUE)
Q_kparam1 = Q_raw_kparam1/36

Community_Chest_Raw = matrix(c(
  1*Q[1,3],0,-2*Q[1,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[1,3],0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  1*Q[6,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[6,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[6,18],0,0,0,
  1*Q[7,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[7,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[7,18],0,0,0,
  1*Q[8,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[8,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[8,18],0,0,0,
  1*Q[9,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[9,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[9,18],0,0,0,
  1*Q[10,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[10,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[10,18],0,0,0,
  
  1*Q[11,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[11,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[11,18],0,0,0,
  1*Q[12,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[12,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[12,18],0,0,0,
  1*Q[13,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[13,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[13,18],0,0,0,
  1*Q[14,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[14,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[14,18],0,0,0,
  1*Q[15,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[15,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[15,18],0,0,0,
  1*Q[16,18],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,-2*Q[16,18],0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[16,18],0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  1*Q[22,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[22,34],0,0,0,0,0,0, 1*Q[22,34],0,0,0,
  1*Q[23,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[23,34],0,0,0,0,0,0, 1*Q[23,34],0,0,0,
  1*Q[24,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[24,34],0,0,0,0,0,0, 1*Q[24,34],0,0,0,
  1*Q[25,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[25,34],0,0,0,0,0,0, 1*Q[25,34],0,0,0,
  1*Q[26,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[26,34],0,0,0,0,0,0, 1*Q[26,34],0,0,0,
  1*Q[27,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[27,34],0,0,0,0,0,0, 1*Q[27,34],0,0,0,
  1*Q[28,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[28,34],0,0,0,0,0,0, 1*Q[28,34],0,0,0,
  1*Q[29,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[29,34],0,0,0,0,0,0, 1*Q[29,34],0,0,0,
  1*Q[30,34],0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[30,34],0,0,0,0,0,0, 1*Q[30,34],0,0,0,
  
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  1*Q[32,34]+1*Q[32,3],0,-2*Q[32,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,-2*Q[32,34],0,0,0,0,0,0,  1*Q[32,34]+1*Q[32,3],0,0,0,
  1*Q[33,3],0,-2*Q[33,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[33,3],0,0,0,
  1*Q[34,3],0,-2*Q[34,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[34,3],0,0,0,
  1*Q[35,3],0,-2*Q[35,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[35,3],0,0,0,
  1*Q[36,3],0,-2*Q[36,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[36,3],0,0,0,
  1*Q[37,3],0,-2*Q[37,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[37,3],0,0,0,
  1*Q[38,3],0,-2*Q[38,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[38,3],0,0,0,
  1*Q[39,3],0,-2*Q[39,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[39,3],0,0,0,
  1*Q[40,3],0,-2*Q[40,3],0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 1*Q[40,3],0,0,0, 

  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0
  
), nrow = 44, byrow = TRUE)

Community_Chest = Community_Chest_Raw/16
Q_w_cc = Q + Community_Chest

Chance_Card_Raw = matrix(c(
  1*Q[1,8],0,0,0,1*Q[1,8],1*Q[1,8],0,-10*Q[1,8],0,0, 0,1*Q[1,8],1*Q[1,8],0,0,2*Q[1,8],0,0,0,0, 0,0,0,0,1*Q[1,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[1,8], 1*Q[1,8],0,0,0,
  1*Q[2,8],0,0,0,1*Q[2,8],1*Q[2,8],0,-10*Q[2,8],0,0, 0,1*Q[2,8],1*Q[2,8],0,0,2*Q[2,8],0,0,0,0, 0,0,0,0,1*Q[2,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[2,8], 1*Q[2,8],0,0,0,
  1*Q[3,8],0,0,0,1*Q[3,8],1*Q[3,8],0,-10*Q[3,8],0,0, 0,1*Q[3,8],1*Q[3,8],0,0,2*Q[3,8],0,0,0,0, 0,0,0,0,1*Q[3,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[3,8], 1*Q[3,8],0,0,0,
  1*Q[4,8],0,0,0,1*Q[4,8],1*Q[4,8],0,-10*Q[4,8],0,0, 0,1*Q[4,8],1*Q[4,8],0,0,2*Q[4,8],0,0,0,0, 0,0,0,0,1*Q[4,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[4,8], 1*Q[4,8],0,0,0,
  1*Q[5,8],0,0,0,1*Q[5,8],1*Q[5,8],0,-10*Q[5,8],0,0, 0,1*Q[5,8],1*Q[5,8],0,0,2*Q[5,8],0,0,0,0, 0,0,0,0,1*Q[5,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[5,8], 1*Q[5,8],0,0,0,
  1*Q[6,8],0,0,0,1*Q[6,8],1*Q[6,8],0,-10*Q[6,8],0,0, 0,1*Q[6,8],1*Q[6,8],0,0,2*Q[6,8],0,0,0,0, 0,0,0,0,1*Q[6,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[6,8], 1*Q[6,8],0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  
  1*Q[11,23],0,0,0,0,1*Q[11,23],0,0,0,0, 0,1*Q[11,23],0,0,0,0,0,0,0,1*Q[11,23], 0,0,-10*Q[11,23],0,1*Q[11,23],2*Q[11,23],0,0,1*Q[11,23],0, 0,0,0,0,0,0,0,0,0,1*Q[11,23], 1*Q[11,23],0,0,0,
  1*Q[12,23],0,0,0,0,1*Q[12,23],0,0,0,0, 0,1*Q[12,23],0,0,0,0,0,0,0,1*Q[12,23], 0,0,-10*Q[12,23],0,1*Q[12,23],2*Q[12,23],0,0,1*Q[12,23],0, 0,0,0,0,0,0,0,0,0,1*Q[12,23], 1*Q[12,23],0,0,0,
  1*Q[13,23],0,0,0,0,1*Q[13,23],0,0,0,0, 0,1*Q[13,23],0,0,0,0,0,0,0,1*Q[13,23], 0,0,-10*Q[13,23],0,1*Q[13,23],2*Q[13,23],0,0,1*Q[13,23],0, 0,0,0,0,0,0,0,0,0,1*Q[13,23], 1*Q[13,23],0,0,0,
  1*Q[14,23],0,0,0,0,1*Q[14,23],0,0,0,0, 0,1*Q[14,23],0,0,0,0,0,0,0,1*Q[14,23], 0,0,-10*Q[14,23],0,1*Q[14,23],2*Q[14,23],0,0,1*Q[14,23],0, 0,0,0,0,0,0,0,0,0,1*Q[14,23], 1*Q[14,23],0,0,0,
  1*Q[15,23],0,0,0,0,1*Q[15,23],0,0,0,0, 0,1*Q[15,23],0,0,0,0,0,0,0,1*Q[15,23], 0,0,-10*Q[15,23],0,1*Q[15,23],2*Q[15,23],0,0,1*Q[15,23],0, 0,0,0,0,0,0,0,0,0,1*Q[15,23], 1*Q[15,23],0,0,0,
  1*Q[16,23],0,0,0,0,1*Q[16,23],0,0,0,0, 0,1*Q[16,23],0,0,0,0,0,0,0,1*Q[16,23], 0,0,-10*Q[16,23],0,1*Q[16,23],2*Q[16,23],0,0,1*Q[16,23],0, 0,0,0,0,0,0,0,0,0,1*Q[16,23], 1*Q[16,23],0,0,0,
  1*Q[17,23],0,0,0,0,1*Q[17,23],0,0,0,0, 0,1*Q[17,23],0,0,0,0,0,0,0,1*Q[17,23], 0,0,-10*Q[17,23],0,1*Q[17,23],2*Q[17,23],0,0,1*Q[17,23],0, 0,0,0,0,0,0,0,0,0,1*Q[17,23], 1*Q[17,23],0,0,0,
  1*Q[18,23],0,0,0,0,1*Q[18,23],0,0,0,0, 0,1*Q[18,23],0,0,0,0,0,0,0,1*Q[18,23], 0,0,-10*Q[18,23],0,1*Q[18,23],2*Q[18,23],0,0,1*Q[18,23],0, 0,0,0,0,0,0,0,0,0,1*Q[18,23], 1*Q[18,23],0,0,0,
  1*Q[19,23],0,0,0,0,1*Q[19,23],0,0,0,0, 0,1*Q[19,23],0,0,0,0,0,0,0,1*Q[19,23], 0,0,-10*Q[19,23],0,1*Q[19,23],2*Q[19,23],0,0,1*Q[19,23],0, 0,0,0,0,0,0,0,0,0,1*Q[19,23], 1*Q[19,23],0,0,0,
  1*Q[20,23],0,0,0,0,1*Q[20,23],0,0,0,0, 0,1*Q[20,23],0,0,0,0,0,0,0,1*Q[20,23], 0,0,-10*Q[20,23],0,1*Q[20,23],2*Q[20,23],0,0,1*Q[20,23],0, 0,0,0,0,0,0,0,0,0,1*Q[20,23], 1*Q[20,23],0,0,0,
  
  1*Q[21,23],0,0,0,0,1*Q[21,23],0,0,0,0, 0,1*Q[21,23],0,0,0,0,0,0,0,1*Q[21,23], 0,0,-10*Q[21,23],0,1*Q[21,23],2*Q[21,23],0,0,1*Q[21,23],0, 0,0,0,0,0,0,0,0,0,1*Q[21,23], 1*Q[21,23],0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  1*Q[25,37],0,0,0,0,3*Q[25,37],0,0,0,0, 0,1*Q[25,37],1*Q[25,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[25,37],0,0,0,0,0, 0,0,0,1*Q[25,37],0,0,-10*Q[25,37],0,0,1*Q[25,37], 1*Q[25,37],0,0,0,
  1*Q[26,37],0,0,0,0,3*Q[26,37],0,0,0,0, 0,1*Q[26,37],1*Q[26,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[26,37],0,0,0,0,0, 0,0,0,1*Q[26,37],0,0,-10*Q[26,37],0,0,1*Q[26,37], 1*Q[26,37],0,0,0,
  1*Q[27,37],0,0,0,0,3*Q[27,37],0,0,0,0, 0,1*Q[27,37],1*Q[27,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[27,37],0,0,0,0,0, 0,0,0,1*Q[27,37],0,0,-10*Q[27,37],0,0,1*Q[27,37], 1*Q[27,37],0,0,0,
  1*Q[28,37],0,0,0,0,3*Q[28,37],0,0,0,0, 0,1*Q[28,37],1*Q[28,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[28,37],0,0,0,0,0, 0,0,0,1*Q[28,37],0,0,-10*Q[28,37],0,0,1*Q[28,37], 1*Q[28,37],0,0,0,
  1*Q[29,37],0,0,0,0,3*Q[29,37],0,0,0,0, 0,1*Q[29,37],1*Q[29,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[29,37],0,0,0,0,0, 0,0,0,1*Q[29,37],0,0,-10*Q[29,37],0,0,1*Q[29,37], 1*Q[29,37],0,0,0,
  1*Q[30,37],0,0,0,0,3*Q[30,37],0,0,0,0, 0,1*Q[30,37],1*Q[30,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[30,37],0,0,0,0,0, 0,0,0,1*Q[30,37],0,0,-10*Q[30,37],0,0,1*Q[30,37], 1*Q[30,37],0,0,0,
  
  1*Q[31,37],0,0,0,0,3*Q[31,37],0,0,0,0, 0,1*Q[31,37],1*Q[31,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[31,37],0,0,0,0,0, 0,0,0,1*Q[31,37],0,0,-10*Q[31,37],0,0,1*Q[31,37], 1*Q[31,37],0,0,0,
  1*Q[32,37],0,0,0,0,3*Q[32,37],0,0,0,0, 0,1*Q[32,37],1*Q[32,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[32,37],0,0,0,0,0, 0,0,0,1*Q[32,37],0,0,-10*Q[32,37],0,0,1*Q[32,37], 1*Q[32,37],0,0,0,
  1*Q[33,37],0,0,0,0,3*Q[33,37],0,0,0,0, 0,1*Q[33,37],1*Q[33,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[33,37],0,0,0,0,0, 0,0,0,1*Q[33,37],0,0,-10*Q[33,37],0,0,1*Q[33,37], 1*Q[33,37],0,0,0,
  1*Q[34,37],0,0,0,0,3*Q[34,37],0,0,0,0, 0,1*Q[34,37],1*Q[34,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[34,37],0,0,0,0,0, 0,0,0,1*Q[34,37],0,0,-10*Q[34,37],0,0,1*Q[34,37], 1*Q[34,37],0,0,0,
  1*Q[35,37],0,0,0,0,3*Q[35,37],0,0,0,0, 0,1*Q[35,37],1*Q[35,37],0,0,0,0,0,0,0, 0,0,0,0,1*Q[35,37],0,0,0,0,0, 0,0,0,1*Q[35,37],0,0,-10*Q[35,37],0,0,1*Q[35,37], 1*Q[35,37],0,0,0,
  1*Q[36,8],0,0,0,1*Q[36,8],1*Q[36,8],0,-10*Q[36,8],0,0, 0,1*Q[36,8],1*Q[36,8],0,0,2*Q[36,8],0,0,0,0, 0,0,0,0,1*Q[36,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[36,8], 1*Q[36,8],0,0,0,
  1*Q[37,8],0,0,0,1*Q[37,8],1*Q[37,8],0,-10*Q[37,8],0,0, 0,1*Q[37,8],1*Q[37,8],0,0,2*Q[37,8],0,0,0,0, 0,0,0,0,1*Q[37,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[37,8], 1*Q[37,8],0,0,0,
  1*Q[38,8],0,0,0,1*Q[38,8],1*Q[38,8],0,-10*Q[38,8],0,0, 0,1*Q[38,8],1*Q[38,8],0,0,2*Q[38,8],0,0,0,0, 0,0,0,0,1*Q[38,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[38,8], 1*Q[38,8],0,0,0,
  1*Q[39,8],0,0,0,1*Q[39,8],1*Q[39,8],0,-10*Q[39,8],0,0, 0,1*Q[39,8],1*Q[39,8],0,0,2*Q[39,8],0,0,0,0, 0,0,0,0,1*Q[39,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[39,8], 1*Q[39,8],0,0,0,
  1*Q[40,8],0,0,0,1*Q[40,8],1*Q[40,8],0,-10*Q[40,8],0,0, 0,1*Q[40,8],1*Q[40,8],0,0,2*Q[40,8],0,0,0,0, 0,0,0,0,1*Q[40,8],0,0,0,0,0, 0,0,0,0,0,0,0,0,0,1*Q[40,8], 1*Q[40,8],0,0,0,

  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,
  0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0
  
), nrow = 44, byrow = TRUE)
Chance_Card = Chance_Card_Raw/16
Q_w_ch = Q + Chance_Card
Q_final = Q + Community_Chest + Chance_Card

Q_final_kparam1 = Q_kparam1 + Community_Chest + Chance_Card

#install.packages("plsgenomics")
#library(plsgenomics)
#install.packages("gplots")
library(gplots)
#matrix.heatmap(Q)
heatmap.2(Q_final,
          Rowv=FALSE,
          Colv=FALSE,
          dendogram='none',
          cellnote = Q_final,
          trace = 'none')


image(1:ncol(Q_final), 1:nrow(Q_final), t(Q_final), col = terrain.colors(2000), axes = FALSE)
axis(1, 1:ncol(Q_final), colnames(Q_final))
axis(2, 1:nrow(Q_final), rownames(Q_final))



temp = diag(44)
for (i in 1:36) {
  temp = temp %*% Q_final
  image(1:ncol(temp),
        1:nrow(temp), t(temp),
        col = hcl.colors(3000, palette = "viridis", alpha = NULL, rev = FALSE, fixup = TRUE),
        #col = cm.colors(3000),
        axes = FALSE,
        xlab = "future space",
        ylab = "current space")
        #title = "Probability p for landing on each square for turn n = 1")
  axis(1, 1:ncol(temp), colnames(temp))
  axis(2, 1:nrow(temp), rownames(temp))
}

errors = c()
for (i in 1:44) {
  errors = c(errors, max(temp[,i]) - min(temp[,i]))
}
max(errors)
  
results = c()
for (i in 1:44) {
  results = c(results, mean(temp[,i]))
}
results
d = data.frame(square = 1:44, p = results)

library(tidyverse)
tibble_d = as_tibble(d)
sorted_d = tibble_d %>% arrange(desc(p))
attach(sorted_d)

library(ggplot2)
ggplot(d, aes(square, p)) +
  geom_point() +
  ggtitle('Probability p Of Landing On Each Square As # Of Turns Converges To Infinity') +
  theme(plot.title = element_text(hjust = 0.5))


library(ggplot2)

type = c(
  "Go", "Brown", "Community Chest", "Brown", "Tax", "Railroads", "Cyan", "Chance Card", "Cyan", "Cyan",
  "Just Passing", "Pink", "Utilities", "Pink", "Pink", "Railroads", "Orange", "Community Chest", "Orange", "Orange",
  "Free Parking", "Red", "Chance Card", "Red", "Red", "Railroads", "Yellow", "Yellow", "Utilities", "Yellow",
  "Jail", "Green", "Green", "Community Chest", "Green", "Railroads", "Chance Card", "Blue", "Tax", "Blue",
  "Jail-0", "Jail-1", "Jail-2", "Jail-3"
)
cbind(d, type)
ggplot(d, aes(square, p, fill = type)) + 
  #geom_bar(stat = 'identity', aes(fill = square < 10 & square > 5), position = 'dodge', col = 'transparent') + 
  #theme_bw() + 
  #scale_fill_discrete(guide = 'none') + 
  geom_bar(stat = "identity", width = .93) +
  scale_fill_manual("Properties",values = c(
    "Go" = "gray70",
    "Community Chest" = "gray70",
    "Chance Card" = "gray70",
    "Tax" = "gray70",
    "Just Passing" = "gray70",
    "Utilities" = "gray70",
    "Free Parking" = "gray70",
    "Jail" = "gray70",
    "Jail-0" = "gray70",
    "Jail-1" = "gray70",
    "Jail-2" = "gray70",
    "Jail-3" = "gray70",
    "Railroads" = "black",
    "Brown" = "brown",
    "Cyan" = "lightskyblue",
    "Pink" = "hotpink",
    "Orange" = "orange",
    "Red" = "red",
    "Yellow" = "yellow",
    "Green" = "green3",
    "Blue" = "blue"

    
    ),
    guide = 'none') +
  theme(plot.title = element_text(hjust = 0.5)) + 
  labs(title = "Probability p Of Landing On Each Square As # Of Turns Converges To Infinity", x = 'square', y = 'p')

# temp = diag(44)
# for (i in 1:50) {
#   temp = Q_w_cc %*% temp
#   image(1:ncol(temp),
#         1:nrow(temp), t(temp),
#         #col = hcl.colors(3000, palette = "viridis", alpha = NULL, rev = FALSE, fixup = TRUE),
#         col = cm.colors(3000),
#         axes = FALSE,
#         xlab = "future space",
#         ylab = "current space")
#   axis(1, 1:ncol(temp), colnames(temp))
#   axis(2, 1:nrow(temp), rownames(temp))
# }






############3
m = c()
for (i in 1:40) {
  m[i] = sum(Q_final[,i])
}
image(1:ncol(temp), 1:nrow(temp), t(temp), col = hsv(), axes = FALSE, xlab = "future space", ylab = "current space")

image(1:ncol(temp), 1:nrow(temp), t(temp), col = heat.colors(200), axes = FALSE, xlab = "future space", ylab = "current space")

image(1:ncol(temp), 1:nrow(temp), t(temp), col = terrain.colors(2000), axes = FALSE, xlab = "future space", ylab = "current space")

###animated heatmap
library(plotly)
v = as.vector(Q)
temp = diag(40)
master = list()

for (i in 1:25) {
  temp = temp %*% Q
  master[[i]] = temp
  #master = c(master, temp)
}
id=1:25
dd <- data.frame(f = as.vector(as.vector(master[[id]])), 
                 x = 1:40,
                 y = 1:40,
                 id = 1:25)
dd <- data.frame(f = as.vector(Q), 
                 x = 1:40,
                 y = 1:40
                 )
p <- ggplot(data= dd, aes(x = x, y = y, frame=f)) +
  stat_bin2d() +
  xlim(1,40) +
  ylim(1,40) +
  guides(fill = guide_colorbar(barwidth = 1, barheight = 5)) +
  scale_fill_gradientn(colours=rev(heat.colors(60)))
p <- ggplotly(p)
p


##other stuff
library(ggplot2)
x=1:40
y=1:40
data=expand.grid(X=x, Y=y)
data$Z = 
ggplot(expand.grid(X=x, Y=y),
       aes(X,Y,fill=Q)) + geom_tile()


######################### values

roll_move = c(2,3,4,5,6,7,8,9,10,11,12)
roll_count = c(1,2,3,4,5,6,5,4,3,2,1)
roll_hist = c(2,3,4,5,6,7,
              3,4,5,6,7,8,
              4,5,6,7,8,9,
              5,6,7,8,9,10,
              6,7,8,9,10,11,
              7,8,9,10,11,12)
roll_x = roll_count/36
roll = data.frame(x = roll_x, y = roll_hist)
library(tidyverse)
library(ggplot2)
ggplot(roll, aes(roll$y)) +
  geom_histogram()

qplot(roll$y, geom = "histogram",
      binwidth = 1,
      main = "Outcomes For Two Dice Rolls", 
      xlab = "Total Roll",
      ylab = "Outcomes",
      fill=I("blue"), 
      col=I("red"), 
      alpha=I(.2),
      xlim=c(1,13)
) + 
  theme(plot.title = element_text(hjust = 0.5))

roll2 = data.frame(x = roll_x, y = roll_hist/36)
qplot(roll$y, geom = "histogram",
      binwidth = 1,
      main = "Probability Of Outcomes For Two Dice Rolls", 
      xlab = "Total Roll",
      ylab = "Probability",
      fill=I("blue"), 
      col=I("red"), 
      alpha=I(.2),
      xlim=c(1,13)
) + 
  theme(plot.title = element_text(hjust = 0.5))

ggplot(roll, aes(y)) +
  geom_histogram(aes(y = ..density..), binwidth=1) +
  geom_density(fill="red", alpha = 0.2) +
  theme_bw() +
  xlab('Total Roll') +
  ylab('Probability') +
  ggtitle('Probabilities of Total Rolls') +
  theme(plot.title = element_text(hjust = 0.5))

